{"cve": {"id": "CVE-2025-22029", "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67", "published": "2025-04-16T15:15:55.510", "lastModified": "2025-04-17T20:22:16.240", "vulnStatus": "Awaiting Analysis", "cveTags": [], "descriptions": [{"lang": "en", "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nexec: fix the racy usage of fs_struct->in_exec\n\ncheck_unsafe_exec() sets fs->in_exec under cred_guard_mutex, then execve()\npaths clear fs->in_exec lockless. This is fine if exec succeeds, but if it\nfails we have the following race:\n\n\tT1 sets fs->in_exec = 1, fails, drops cred_guard_mutex\n\n\tT2 sets fs->in_exec = 1\n\n\tT1 clears fs->in_exec\n\n\tT2 continues with fs->in_exec == 0\n\nChange fs/exec.c to clear fs->in_exec with cred_guard_mutex held."}, {"lang": "es", "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: exec: se corrige el uso excesivo de fs_struct-&gt;in_exec. check_unsafe_exec() establece fs-&gt;in_exec bajo cred_guard_mutex, y luego las rutas execve() limpian fs-&gt;in_exec sin bloqueo. Esto funciona correctamente si exec tiene \u00e9xito, pero si falla, tenemos la siguiente ejecuci\u00f3n: T1 establece fs-&gt;in_exec = 1, falla y elimina cred_guard_mutex. T2 establece fs-&gt;in_exec = 1. T1 limpia fs-&gt;in_exec. T2 contin\u00faa con fs-&gt;in_exec == 0. Modifique fs/exec.c para limpiar fs-&gt;in_exec con cred_guard_mutex retenido."}], "metrics": {}, "references": [{"url": "https://git.kernel.org/stable/c/753a620a7f8e134b444f89fe90873234e894e21a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/a6b5070721503fb6021ebed51c925ffc66b1c5ab", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/af7bb0d2ca459f15cb5ca604dab5d9af103643f0", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/b519f2e5800fe2391b7545ba6889df795828e885", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}, {"url": "https://git.kernel.org/stable/c/e2d8e7bd3314485e0b3b08380c659b3d1d67ed6a", "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"}]}}